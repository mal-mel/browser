<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Download page</title>
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css" integrity="sha384-Gn5384xqQ1aoWXA+058RXPxPg6fy4IWvTNh0E263XmFcJlSAwiGgFAW/dAiS6JXm" crossorigin="anonymous">
    <link rel="stylesheet" type="text/css" href="{{url_for('static', filename = 'css/style.css')}}">
</head>
<body>
	<!--<form method="post", enctype="multipart/form-data">
		<div class="input-file-container">  
    		<input class="input-file" id="my-file" type="file" accept="image/*">
    		<label tabindex="0" for="my-file" class="input-file-trigger">Select a file...</label>
  		</div>
  		<p class="file-return"></p>
  		<input type="file" name="img", accept="image/*" multiple="multiple">
  		<a href="#" class="submit button">Загрузить файлы</a>
		<button type="submit">send</button>
	</form>-->
	<form id="upload-file" method="post" enctype="multipart/form-data">
		<input type="file" multiple="multiple" accept="image/*" name="img" required="">
		<a href="#" class="submit button">Загрузить файлы</a>
	</form>
	<div class="ajax-respond">
		{% for file in files %}
			<a href="/uploads/{{ file }}">{{ file }}</a>
			<br>
		{% endfor %}
	</div>


	<script src="https://code.jquery.com/jquery-3.1.1.min.js"></script>
	<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.12.9/umd/popper.min.js" integrity="sha384-ApNbgh9B+Y1QKtv3Rn7W3mgPxhU9K/ScQsAP7hUibX39j7fakFPskvXusvfa0b4Q" crossorigin="anonymous"></script>
	<script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/js/bootstrap.min.js" integrity="sha384-JZR6Spejh4U02d8jOt6vLEHfe/JQGiRRSQQxSfFWpi1MquVdAyjUar5+76PVCmYl" crossorigin="anonymous"></script>
	<script type="text/javascript">
		var files;
 
		$('input[type=file]').change(function(){
		    files = this.files;
		});

		$('.submit.button').click(function( event ){
		    event.stopPropagation(); // Остановка происходящего
		    event.preventDefault();  // Полная остановка происходящего
		 
		    // Создадим данные формы и добавим в них данные файлов из files
		 
		    var form_data = new FormData($('#upload-file')[0]);
		    // Отправляем запрос
		 
		    $.ajax({
		        url: './',
		        type: 'POST',
		        data: form_data,
		        cache: false,
		        dataType: 'json',
		        processData: false,
		        contentType: false,
		        async: false,
		        success: function( respond, textStatus, jqXHR ){
		 
		            // Если все ОК
		            if( typeof respond.error === 'undefined' ){
		                // Файлы успешно загружены, делаем что нибудь здесь
		 
		                // выведем пути к загруженным файлам в блок '.ajax-respond'
		 				var html = $('.ajax-respond').html();
		                $('.ajax-respond').html( html + respond.files );
		                alert('Файлы успешно загружены!');
		            }
		            else{
		                console.log('ОШИБКИ ОТВЕТА сервера: ' + respond.error );
		            }
		        },
		        error: function( jqXHR, textStatus, errorThrown ){
		            console.log('ОШИБКИ AJAX запроса: ' + errorThrown );
		        }
		    });
		 
		});
	</script>
</body>
</html>